<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        img{
            width: 200px;
            height: 200px;
        }
        .row{
            margin-top: 20px;
        }
        </style>
</head>
<body onload="carregar()">
    
    <div id="produtos" class="container">


        
    </div>

    <button onclick="logout()"> Sair</button>
    
</body>
<script>

    if(!localStorage.getItem("token")){
        localStorage.removeItem("user");
        localStorage.removeItem("userId");
        localStorage.removeItem("email");
        localStorage.removeItem("telefone");
        window.location.href = "index.html";
    }
    else{
        var userName = localStorage.getItem("user");
        document.getElementById("userName").innerText = "bem vindo Sr(a)"+ " " +userName;
    }

        async function logout(){

            var token = localStorage.getItem("token");

            await fetch("http://localhost:3000/api/users/logout", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${token}`
                }
            }).then(response => response.json())
            .then(data => {
            localStorage.removeItem("token");
            window.location.href = "login.html";
            })
            .catch(error => {
                console.error("Erro ao fazer logout:", error);
            });
 
        }

async function carregarProduct(i,divRow){

 await fetch(`https://fakestoreapi.com/products/${i}`,
    ).then(response => response.json())
    .then(data => { 
        console.log(data);
        var prod = document.getElementById("produtos");
        
        var divCol = document.createElement("div");
        divCol.classList.add("col-md-4","mb-4");
        divCard = document.createElement("div");
        divCard.classList.add("card",'p3');
        var img = document.createElement("img");
        img.src = data.image;

        divCard.appendChild(img);
        divCol.appendChild(divCard);
       divRow.appendChild(divCol);
       prod.appendChild(divRow);
      



       

})


}

function carregar(){

  
    for(var l=1; l<=5; l++){
       var divRow = document.createElement("div");
        divRow.classList.add("row");
        for(var i=1; i<=5; i++){
          
            carregarProduct(i,divRow);
        }
       
    }   
}


</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
</html>